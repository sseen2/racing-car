<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>ìë™ì°¨ ê²½ì£¼</title>
</head>

<body>
    <div class="container">
        <h1>ğŸš— ìë™ì°¨ ê²½ì£¼</h1>
        <p>ìë™ì°¨ ê²½ì£¼ ê²Œì„ì„ ì‹œì‘í•˜ë ¤ë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>

        <form onsubmit="startGame(event);">
            <div>
                <label for="carName">ìë™ì°¨ ì´ë¦„</label>
                <input type="text" id="carName" name="carName" required />
            </div>
            <div>
                <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" id="password" name="password" required />
            </div>

            <p id="errorMessage" style="color: red; margin-top: 8px;"></p>

            <button type="submit" class="btn">ê²Œì„ ì‹œì‘</button>
        </form>
    </div>

    <script>
        async function startGame() {
            event.preventDefault();

            const carName = document.getElementById('carName').value.trim();
            const password = document.getElementById('password').value.trim();
            const errorEl = document.getElementById('errorMessage');

            errorEl.textContent = '';

            if (!carName || !password) {
                errorEl.textContent = "ìë™ì°¨ ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.";
                return;
            }

            try {
                const response = await fetch('/api/car/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        carName: carName,
                        password: password
                    })
                });

                const result = await response.json();

                if (!response.ok || !result.success) {
                    errorEl.textContent = result.message;
                    return;
                }

                window.location.href = '/room';
            } catch (error) {
                console.error(error);
                alert(error);
            }
        }
    </script>
</body>
</html>